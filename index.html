<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<title>Customer Satisfaction Survey</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>

<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css'>
<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.0/css/bootstrapValidator.min.css'><link rel="stylesheet" href="./style.css">
</head>

<body>
<div class="container">

<form class="well form-horizontal" id="google-form">
<fieldset>

<!-- Form Name -->
  <table width="98%" border="0" align="center">
  <tr>
    <td width="15%" valign="top"><img src="BEST-logo.png" style="width: 70%; height: auto;"></td>
    <td><legend><center><h3><b>客戶滿意度問卷調查表<br>Customer Satisfaction Survey</b></h3></center></legend></td>
    <td width="15%">&nbsp;</td>    
  </tr>
  <tr>
    <td colspan="3" valign="top">Dear Valued Customer,<br>To help us improve our quality and service, we kindly ask you to take 1-2 minutes to complete this questionnaire.<br>All items are rated on a scale of 1 to 5; please check the appropriate box in each field.
    </td>    
  </tr>
  <tr>
    <td colspan="3">&nbsp;</td>    
  </tr>   
  <tr>
    <td colspan="3" valign="top">親愛的客戶，您好：<br>為提升我們的品質與服務，懇請您撥冗花1-2分鐘填寫本問卷；所有項目採1-5分評分，請在欄位中勾選即可。</td>    
  </tr> 
  <tr height="20">
    <td colspan="3">&nbsp;</td>    
  </tr>      
  <tr height="20">
    <td colspan="3"><p style="text-decoration: underline;"><b>基本資料填寫(Basic Information)</b></p></td>    
  </tr>     
</table>
 
<!-- Text input-->

<div class="form-group">
  <label class="col-md-3 control-label" style="width: 20%;text-align: left !important;text-indent: 1em;font-weight: normal;">公司名稱(Company Name)</label>  
  <div class="col-md-6 inputGroupContainer">
  <div class="input-group">
  <input  name="company_name" id="company_name" placeholder="Company Name" class="form-control"  type="text" style="border-radius: 4px;width: 400px;" required>
    </div>
  </div>
</div>

<!-- Text input-->

<div class="form-group">
  <label class="col-md-3 control-label" style="width: 20%;text-align: left !important;text-indent: 1em;font-weight: normal;">部門(Department)</label> 
    <div class="col-md-6 inputGroupContainer">
    <div class="input-group">
  <input name="department" id="department" placeholder="Department" class="form-control"  type="text" style="border-radius: 4px;width: 400px;">
    </div>
  </div>
</div>  
  
<div class="form-group">
  <label class="col-md-3 control-label" style="width: 20%;text-align: left !important;text-indent: 1em;font-weight: normal;">職稱(Position)</label> 
    <div class="col-md-6 inputGroupContainer">
    <div class="input-group">
  <input name="position" id="position" placeholder="Position" class="form-control"  type="text" style="border-radius: 4px;width: 400px;">
    </div>
  </div>
</div>
  
<!-- Text input-->

<div class="form-group">
  <label class="col-md-3 control-label" style="width: 20%;text-align: left !important;text-indent: 1em;font-weight: normal;">姓名(Name)</label>  
  <div class="col-md-6 inputGroupContainer">
  <div class="input-group">
  <input  name="name" id="name" placeholder="Name" class="form-control"  type="text" style="border-radius: 4px;width: 400px;">
    </div>
  </div>
</div>

<!-- Text input-->

<div class="form-group">
  <label class="col-md-3 control-label" style="width: 20%;text-align: left !important;text-indent: 1em;font-weight: normal;">郵箱(Email)</label> 
    <div class="col-md-6 inputGroupContainer">
    <div class="input-group">
  <input name="email" id="email" placeholder="Email" class="form-control"  type="text" style="border-radius: 4px;width: 400px;">
    </div>
  </div>
</div>

<br><p style="text-indent: 1em"><b>一、技術能力（25分）Technical Capability & Problem-Solving (25 Points)</b></p>
<div class="form-group" style="margin-bottom: 20px;">
<label class="col-md-4 control-label" style="width: 20%; text-align: left !important; font-weight: normal; padding-left: 4em; text-indent: -1.2em;">
  1、加工/材料專業理解<br>
  Understanding of machining/material characteristics
</label> 

  <div class="col-md-9">
    <div style="display: flex; align-items: flex-start; gap: 8px;">
      <input type="radio" id="item1_5" name="item1" value="5 非常滿意" style="margin-left: 30px;margin-top: 5px;">
      <label for="item1_5" style="font-weight: normal; cursor: pointer; line-height: 1.4;">
        5 非常滿意<br>[Extremely Satisfied]
      </label>
      <input type="radio" id="item1_4" name="item1" value="4 滿意" style="margin-left: 30px;margin-top: 5px;">
      <label for="item1_4" style="font-weight: normal; cursor: pointer; line-height: 1.4;">
        4 滿意<br>[Very Satisfied]
      </label>  
      <input type="radio" id="item1_3" name="item1" value="3 普通" style="margin-left: 30px;margin-top: 5px;">
      <label for="item1_3" style="font-weight: normal; cursor: pointer; line-height: 1.4;">
        3 普通<br>[Satisfied]
      </label>   
      <input type="radio" id="item1_2" name="item1" value="2 不滿意" style="margin-left: 30px;margin-top: 5px;">
      <label for="item1_2" style="font-weight: normal; cursor: pointer; line-height: 1.4;">
        2 不滿意<br>[Fair]
      </label>
      <input type="radio" id="item1_1" name="item1" value="1 非常不滿意" style="margin-left: 30px;margin-top: 5px;">
      <label for="item1_1" style="font-weight: normal; cursor: pointer; line-height: 1.4;">
        1 非常不滿意<br>[Dissatisfied]
      </label>      
    </div>
    
  </div>
</div>
<!-- Text input-->

<!-- Success message -->
<div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Success!.</div>

<!-- Button -->
<div class="form-group">
  <label class="col-md-4 control-label"></label>
  <div class="col-md-4" style="text-align: center;"><br>
    <button class="btn btn-warning" >&nbsp&nbsp送出(SUBMIT)&nbsp&nbsp<span class="glyphicon glyphicon-send"></span></button>
  </div>
</div>

</fieldset>
</form>
</div>
</div><!-- /.container -->

<!--===============================================================================================-->    
<script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/bootstrap-validator/0.4.5/js/bootstrapvalidator.min.js'></script><script  src="./script.js"></script>
<script>
$('#google-form').submit(function (e) {
  e.preventDefault();

  // 檢查必填欄位
  if ($('#company_name').val()) {
    $.ajax({
      url: "https://docs.google.com/forms/u/0/d/e/1FAIpQLSfehspoDvGEklO90QeRY0SGaJWai5E2R8UhM2d3VwsaPh8W0A/formResponse",
      crossDomain: true,
      data: {
        "entry.1888997779": $('#company_name').val(),
        "entry.517603240": $('#department').val(),
        "entry.604321381": $('#position').val(),
        "entry.1106653741": $('#name').val(), 
        "entry.1892545043": $('#email').val(),         
        "entry.1781783572": $('input[name="item1"]:checked').val()
      },
      type: "POST",
      // 改用 xml 避免 JSONP 錯誤解析，即使噴出 CORS 錯誤，資料通常也會送達
      dataType: "xml", 
      statusCode: {
        0: function() {
          // 因為跨網域，Google 不會回傳成功狀態碼，通常 status 為 0 代表成功送出
          handleSuccess();
        },
        200: function() {
          handleSuccess();
        }
      },
      error: function() {
        // 即使進入 error，只要資料沒錯，通常 Google 已經收到了
        handleSuccess();
      }
    });
  }
});

function handleSuccess() {
  $('#company_name').val('');
  $('#department').val('');
  $('#position').val('');
  $('#name').val('');
  $('#email').val('');
  $('input[name="item1"]').prop('checked', false);
  // alert("感謝您的填寫！");
  window.location.replace("thank.html");
}
  </script>
 <!--===============================================================================================-->
  </body>
  
</html>
